# ==============================================================================
# .htaccess for React Single Page Application (SPA)
# ==============================================================================

<IfModule mod_rewrite.c>
    # Enable the rewrite engine
    RewriteEngine On
    
    # --------------------------------------------------------------------------
    # SECTION 1: FORCE HTTPS (SECURITY)
    # Redirect all HTTP traffic to HTTPS for security.
    # --------------------------------------------------------------------------
    RewriteCond %{HTTPS} !=on
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # --------------------------------------------------------------------------
    # SECTION 2: REACT ROUTER FIX (SPA Core Logic)
    # If the requested resource is not a real file or directory on the server,
    # redirect the request to the main index.html file. This allows
    # React Router to handle the client-side routing.
    # --------------------------------------------------------------------------
    
    # Set the base path
    RewriteBase /
    
    # Do not apply the rule for existing files
    RewriteCond %{REQUEST_FILENAME} !-f
    # Do not apply the rule for existing directories
    RewriteCond %{REQUEST_FILENAME} !-d
    
    # For all other requests, serve index.html
    RewriteRule ^ index.html [L]

</IfModule>

# ==============================================================================
# SECTION 3: BROWSER CACHING (PERFORMANCE)
# Instruct browsers to cache static files for faster loading times.
# ==============================================================================

<IfModule mod_expires.c>
    ExpiresActive On
    
    # Cache images and media for 1 month
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/webp "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType image/x-icon "access plus 1 month"
    
    # Cache CSS and JavaScript files for 1 week
    # Their names usually change with new builds, so this is safe.
    ExpiresByType text/css "access plus 1 week"
    ExpiresByType application/javascript "access plus 1 week"
    
    # Cache fonts for 1 year
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
    
</IfModule>

# ==============================================================================
# SECTION 4: COMPRESSION (PERFORMANCE)
# Compress text-based assets before sending them to the browser.
# ==============================================================================
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>